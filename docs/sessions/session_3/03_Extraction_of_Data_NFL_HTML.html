<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.6.42">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Immanuel Williams &amp; Ciera Millard">
<meta name="dcterms.date" content="2025-07-11">

<title>Session 3: NFL Sports Data ‚Äì Data Extraction Workshop (USCOTS 2025)</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../">
<script src="../../site_libs/quarto-html/quarto.js"></script>
<script src="../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting-2f5df379a58b258e96c21c0638c20c03.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../site_libs/bootstrap/bootstrap-6bd9cfa162949bde0a231f530c97869d.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>


<link rel="stylesheet" href="../../styles.css">
</head>

<body class="nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a class="navbar-brand" href="../../index.html">
    <span class="navbar-title">Data Extraction Workshop (USCOTS 2025)</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" role="menu" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link" href="../../index.html"> 
<span class="menu-text">Home</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../about.html"> 
<span class="menu-text">About</span></a>
  </li>  
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-sessions" role="link" data-bs-toggle="dropdown" aria-expanded="false">
 <span class="menu-text">Sessions</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-sessions">    
        <li>
    <a class="dropdown-item" href="../../sessions/session_1/01_Extraction_Introduction.html">
 <span class="dropdown-text">Session 1 - Introduction</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../sessions/session_1/libraries_of_packages.html">
 <span class="dropdown-text">Libraries &amp; Packages</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../sessions/session_2/02_Extraction_Weather_Data_API.html">
 <span class="dropdown-text">Session 2 - Weather API</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../sessions/session_3/03_Extraction_of_Data_NFL_HTML.html">
 <span class="dropdown-text">Session 3 - NFL HTML</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../sessions/session_4/04_Extraction_FinalActivity.html">
 <span class="dropdown-text">Session 4 - Final Activity</span></a>
  </li>  
    </ul>
  </li>
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-outlines" role="link" data-bs-toggle="dropdown" aria-expanded="false">
 <span class="menu-text">Outlines</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-outlines">    
        <li>
    <a class="dropdown-item" href="../../outlines_and_organization/unorganized-outline.html">
 <span class="dropdown-text">Unorganized Outline</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../outlines_and_organization/organized-outline.html">
 <span class="dropdown-text">Organized Outline</span></a>
  </li>  
    </ul>
  </li>
</ul>
          </div> <!-- /navcollapse -->
            <div class="quarto-navbar-tools">
</div>
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#p1.-review-of-key-functions-and-concepts" id="toc-p1.-review-of-key-functions-and-concepts" class="nav-link active" data-scroll-target="#p1.-review-of-key-functions-and-concepts">P1. Review of Key Functions and Concepts</a>
  <ul class="collapse">
  <li><a href="#extracting-items-with-pluck" id="toc-extracting-items-with-pluck" class="nav-link" data-scroll-target="#extracting-items-with-pluck">1. Extracting Items with <code>pluck</code> ü§è</a></li>
  <li><a href="#cleaning-data-with-janitor" id="toc-cleaning-data-with-janitor" class="nav-link" data-scroll-target="#cleaning-data-with-janitor">2. Cleaning Data with <code>janitor</code> üßπ</a></li>
  <li><a href="#simple-renaming-with-rename" id="toc-simple-renaming-with-rename" class="nav-link" data-scroll-target="#simple-renaming-with-rename">3. Simple Renaming with <code>rename</code> ‚úçÔ∏è</a></li>
  <li><a href="#advanced-renaming-with-rename_with" id="toc-advanced-renaming-with-rename_with" class="nav-link" data-scroll-target="#advanced-renaming-with-rename_with">4. Advanced Renaming with <code>rename_with</code> üîÅ</a></li>
  <li><a href="#selecting-columns-with-and" id="toc-selecting-columns-with-and" class="nav-link" data-scroll-target="#selecting-columns-with-and">5. Selecting Columns with <code>!</code> and <code>:</code> üéØ</a></li>
  <li><a href="#understanding-regular-expressions-regex" id="toc-understanding-regular-expressions-regex" class="nav-link" data-scroll-target="#understanding-regular-expressions-regex">6. Understanding Regular Expressions (<code>regex</code>) üßê</a></li>
  <li><a href="#across-for-mass-changes" id="toc-across-for-mass-changes" class="nav-link" data-scroll-target="#across-for-mass-changes">7. <code>across()</code> for Mass Changes ‚ö°Ô∏è</a></li>
  <li><a href="#conditional-logic-with-case_when" id="toc-conditional-logic-with-case_when" class="nav-link" data-scroll-target="#conditional-logic-with-case_when">8. Conditional Logic with <code>case_when</code> ü§î</a></li>
  </ul></li>
  <li><a href="#p2.-html-concepts" id="toc-p2.-html-concepts" class="nav-link" data-scroll-target="#p2.-html-concepts">P2. HTML Concepts</a>
  <ul class="collapse">
  <li><a href="#how-html-builds-a-web-page" id="toc-how-html-builds-a-web-page" class="nav-link" data-scroll-target="#how-html-builds-a-web-page">How HTML Builds a Web Page</a></li>
  <li><a href="#finding-a-specific-element-the-table" id="toc-finding-a-specific-element-the-table" class="nav-link" data-scroll-target="#finding-a-specific-element-the-table">Finding a Specific Element: The Table</a></li>
  <li><a href="#anatomy-of-an-html-table" id="toc-anatomy-of-an-html-table" class="nav-link" data-scroll-target="#anatomy-of-an-html-table">Anatomy of an HTML Table</a></li>
  </ul></li>
  <li><a href="#p3.-desired-rvest-functions" id="toc-p3.-desired-rvest-functions" class="nav-link" data-scroll-target="#p3.-desired-rvest-functions">P3. Desired <code>rvest</code> functions</a>
  <ul class="collapse">
  <li><a href="#p_sub_1-reading-the-html-file" id="toc-p_sub_1-reading-the-html-file" class="nav-link" data-scroll-target="#p_sub_1-reading-the-html-file">P_sub_1: Reading the HTML File</a></li>
  <li><a href="#p_sub_2-extracting-the-first-table-with-pluck" id="toc-p_sub_2-extracting-the-first-table-with-pluck" class="nav-link" data-scroll-target="#p_sub_2-extracting-the-first-table-with-pluck">P_sub_2: Extracting the First Table with <code>pluck()</code></a></li>
  <li><a href="#p_sub_3-extracting-the-second-table-with-pluck" id="toc-p_sub_3-extracting-the-second-table-with-pluck" class="nav-link" data-scroll-target="#p_sub_3-extracting-the-second-table-with-pluck">P_sub_3: Extracting the Second Table with <code>pluck()</code></a></li>
  </ul></li>
  <li><a href="#p4.-extract-nfl-data" id="toc-p4.-extract-nfl-data" class="nav-link" data-scroll-target="#p4.-extract-nfl-data">P4. Extract NFL Data</a>
  <ul class="collapse">
  <li><a href="#step-1-retrieve-the-game-data" id="toc-step-1-retrieve-the-game-data" class="nav-link" data-scroll-target="#step-1-retrieve-the-game-data">Step 1: Retrieve the Game Data</a></li>
  <li><a href="#step-2-clean-the-column-headers" id="toc-step-2-clean-the-column-headers" class="nav-link" data-scroll-target="#step-2-clean-the-column-headers">Step 2: Clean the Column Headers</a></li>
  <li><a href="#step-3-tidy-and-transform-the-data" id="toc-step-3-tidy-and-transform-the-data" class="nav-link" data-scroll-target="#step-3-tidy-and-transform-the-data">Step 3: Tidy and Transform the Data</a></li>
  </ul></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Session 3: NFL Sports Data</h1>
</div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>Immanuel Williams &amp; Ciera Millard </p>
          </div>
  </div>
    
    <div>
    <div class="quarto-title-meta-heading">Published</div>
    <div class="quarto-title-meta-contents">
      <p class="date">July 11, 2025</p>
    </div>
  </div>
  
    
  </div>
  


</header>


<p><!-- Delete this in Python Note Books --> <a href="../../sessions/session_3/03_Extraction_of_Data_NFL_HTML.html">Download starter .qmd file</a></p>
<p>(TODOs: Add introduction with Images)</p>
<section id="p1.-review-of-key-functions-and-concepts" class="level2">
<h2 class="anchored" data-anchor-id="p1.-review-of-key-functions-and-concepts">P1. Review of Key Functions and Concepts</h2>
<p>Of course. Here is a structured guide with concise explanations and sample data to effectively teach these R concepts for a web scraping workshop. The goal is to give attendees a clear understanding of what the code does without getting lost in details.</p>
<div style="height: 300px; background-color: white;">

</div>
<section id="extracting-items-with-pluck" class="level3">
<h3 class="anchored" data-anchor-id="extracting-items-with-pluck">1. Extracting Items with <code>pluck</code> ü§è</h3>
<p><code>pluck()</code> from the <code>purrr</code> package is for safely pulling out a single piece of data from a list or a data frame column that contains lists.</p>
<p><strong>Fake Data</strong>: Imagine you scraped data and have a list of authors for each book.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tibble)</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(purrr)</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a>book_data <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">title =</span> <span class="fu">c</span>(<span class="st">"The Hobbit"</span>, <span class="st">"Dune"</span>),</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">details =</span> <span class="fu">list</span>(</span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">list</span>(<span class="at">author =</span> <span class="st">"Tolkien"</span>, <span class="at">year =</span> <span class="dv">1937</span>),</span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a>    <span class="fu">list</span>(<span class="at">author =</span> <span class="st">"Herbert"</span>, <span class="at">year =</span> <span class="dv">1965</span>)</span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a>book_data</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p><strong>Code Demo</strong>: Let‚Äôs ‚Äúpluck‚Äù the author from the first book‚Äôs details.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Get the 'author' from the first element of the 'details' column</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a><span class="fu">pluck</span>(book_data, <span class="st">"details"</span>, <span class="dv">1</span>, <span class="st">"author"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>This is like telling R: go into <code>book_data</code>, find the <code>details</code> column, go to its <code>first</code> element, and grab the value named <code>author</code>.</p>
<div style="height: 300px; background-color: white;">

</div>
</section>
<section id="cleaning-data-with-janitor" class="level3">
<h3 class="anchored" data-anchor-id="cleaning-data-with-janitor">2. Cleaning Data with <code>janitor</code> üßπ</h3>
<p>The <code>janitor</code> package is your best friend for cleaning up messy data.</p>
<p><strong>Fake Data</strong>: Data scraped from a website often has messy column names and extra empty spaces.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(janitor)</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>messy_data <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a>  <span class="st">`</span><span class="at">First Name</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">c</span>(<span class="st">"gandalf"</span>, <span class="st">"frodo"</span>, <span class="cn">NA</span>),</span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a>  <span class="st">`</span><span class="at">Last Name</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">c</span>(<span class="st">"the grey"</span>, <span class="st">"baggins"</span>, <span class="cn">NA</span>),</span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a>  <span class="st">`</span><span class="at">AGE</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">c</span>(<span class="st">"2019"</span>, <span class="st">"50"</span>, <span class="cn">NA</span>)</span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-9"><a href="#cb3-9" aria-hidden="true" tabindex="-1"></a>messy_data</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div style="height: 300px; background-color: white;">

</div>
<p><strong>Code Demos</strong>:</p>
<ol type="1">
<li><strong><code>clean__names()</code></strong> makes column names neat and consistent (snake_case).</li>
</ol>
<div class="cell">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>cleaned_data <span class="ot">&lt;-</span> <span class="fu">clean_names</span>(messy_data)     <span class="co"># colnames(cleaned_data)     </span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>cleaned_data</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<ol start="2" type="1">
<li><strong><code>remove_empty()</code></strong> gets rid of empty rows or columns.</li>
</ol>
<div class="cell">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="co"># The third row is empty, so it gets removed     </span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a><span class="fu">remove_empty</span>(cleaned_data, <span class="at">which =</span> <span class="st">"rows"</span>)     </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<ol start="3" type="1">
<li><strong><code>adorn_totals()</code></strong> is powerful for quickly adding sums.</li>
</ol>
<div class="cell">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Let's use a numeric data frame     </span></span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>sales <span class="ot">&lt;-</span> <span class="fu">tibble</span>(         </span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">product =</span> <span class="fu">c</span>(<span class="st">"A"</span>, <span class="st">"B"</span>),         </span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">q1_sales =</span> <span class="fu">c</span>(<span class="dv">100</span>, <span class="dv">200</span>),         </span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">q2_sales =</span> <span class="fu">c</span>(<span class="dv">150</span>, <span class="dv">250</span>))  <span class="sc">%&gt;%</span>  </span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">adorn_totals</span>(sales, <span class="at">where =</span> <span class="st">"row"</span>)     </span>
<span id="cb6-7"><a href="#cb6-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-8"><a href="#cb6-8" aria-hidden="true" tabindex="-1"></a>sales</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div style="height: 300px; background-color: white;">

</div>
</section>
<section id="simple-renaming-with-rename" class="level3">
<h3 class="anchored" data-anchor-id="simple-renaming-with-rename">3. Simple Renaming with <code>rename</code> ‚úçÔ∏è</h3>
<p>The <code>rename()</code> function from <code>dplyr</code> is the most direct way to rename one or more specific columns. The pattern is always <strong><code>new_name = old_name</code></strong>.</p>
<p><strong>Fake Data</strong>: Let‚Äôs use our cleaned data from before.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; # A tibble: 3 √ó 3</span></span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   first_name last_name age</span></span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   &lt;chr&gt;      &lt;chr&gt;     &lt;chr&gt;</span></span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 1 gandalf    the grey  2019</span></span>
<span id="cb7-7"><a href="#cb7-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2 frodo      baggins   50</span></span>
<span id="cb7-8"><a href="#cb7-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 3 NA         NA        NA</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p><strong>Code Demo</strong>: Let‚Äôs change <code>age</code> to <code>character_age</code>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a>cleaned_data <span class="sc">%&gt;%</span></span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">character_age =</span> age)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div style="height: 300px; background-color: white;">

</div>
</section>
<section id="advanced-renaming-with-rename_with" class="level3">
<h3 class="anchored" data-anchor-id="advanced-renaming-with-rename_with">4. Advanced Renaming with <code>rename_with</code> üîÅ</h3>
<p><code>rename_with()</code> is for changing many column names at once using a <strong>pattern</strong>. It‚Äôs perfect when you want to apply the same rule to multiple columns.</p>
<p><strong>Fake Data</strong>: Imagine your scraped data has a weird prefix on several columns.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>data_with_prefix <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>  <span class="st">`</span><span class="at">_name</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">c</span>(<span class="st">"Aragorn"</span>, <span class="st">"Legolas"</span>),</span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a>  <span class="st">`</span><span class="at">_race</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">c</span>(<span class="st">"Human"</span>, <span class="st">"Elf"</span>),</span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a>  <span class="st">`</span><span class="at">id</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>)</span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p><strong>Code Demo</strong>: Let‚Äôs remove the leading underscore <code>_</code> from every column that starts with one.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(stringr)</span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a>data_with_prefix <span class="sc">%&gt;%</span></span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename_with</span>(<span class="sc">~</span> <span class="fu">str_replace</span>(., <span class="st">"^_"</span>, <span class="st">""</span>), <span class="at">.cols =</span> <span class="fu">starts_with</span>(<span class="st">"_"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<ul>
<li><code>rename_with(...)</code>: ‚ÄúI want to rename some columns.‚Äù</li>
<li><code>~ str_replace(., "^_", "")</code>: The rule is to replace a <code>^</code> (start of the text) followed by <code>_</code> with nothing (<code>""</code>). The <code>.</code> is a placeholder for the column name.</li>
<li><code>.cols = starts_with("_")</code>: ‚ÄúOnly apply this rule to columns that start with <code>_</code>.‚Äù</li>
</ul>
<div style="height: 300px; background-color: white;">

</div>
</section>
<section id="selecting-columns-with-and" class="level3">
<h3 class="anchored" data-anchor-id="selecting-columns-with-and">5. Selecting Columns with <code>!</code> and <code>:</code> üéØ</h3>
<p>You can use <code>select()</code> from <code>dplyr</code> to keep or remove columns.</p>
<ul>
<li><code>:</code> (colon) selects a <strong>range of columns</strong>.</li>
<li><code>!</code> (bang) <strong>removes</strong> a column.</li>
</ul>
<p><strong>Fake Data</strong>:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a>character_stats <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">name =</span> <span class="fu">c</span>(<span class="st">"Gimli"</span>, <span class="st">"Samwise"</span>),</span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">race =</span> <span class="fu">c</span>(<span class="st">"Dwarf"</span>, <span class="st">"Hobbit"</span>),</span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">weapon =</span> <span class="fu">c</span>(<span class="st">"Axe"</span>, <span class="st">"Frying Pan"</span>),</span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">age =</span> <span class="fu">c</span>(<span class="dv">139</span>, <span class="dv">33</span>)</span>
<span id="cb11-6"><a href="#cb11-6" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p><strong>Code Demos</strong>:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 1. Select all columns FROM 'race' TO 'weapon'</span></span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>character_stats <span class="sc">%&gt;%</span> </span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(race<span class="sc">:</span>weapon)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 2. Select everything EXCEPT the 'age' column</span></span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>character_stats <span class="sc">%&gt;%</span> </span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">!</span>age)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div style="height: 300px; background-color: white;">

</div>
</section>
<section id="understanding-regular-expressions-regex" class="level3">
<h3 class="anchored" data-anchor-id="understanding-regular-expressions-regex">6. Understanding Regular Expressions (<code>regex</code>) üßê</h3>
<p>A <strong>regular expression</strong> (or regex) is a pattern used to find and match text. It looks weird, but it‚Äôs just a set of rules.</p>
<p>Let‚Äôs break down this regex for finding numbers: <code>^\\s*-?\\d*\\.?\\d+\\s*$</code></p>
<table class="caption-top table">
<colgroup>
<col style="width: 15%">
<col style="width: 60%">
<col style="width: 23%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">Part</th>
<th style="text-align: left;">Meaning</th>
<th style="text-align: left;">Example Matches</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;"><code>^</code></td>
<td style="text-align: left;">Start of the string</td>
<td style="text-align: left;"></td>
</tr>
<tr class="even">
<td style="text-align: left;"><code>\\s*</code></td>
<td style="text-align: left;">Zero or more whitespace characters (<code>\s</code>)</td>
<td style="text-align: left;">(space)</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><code>-?</code></td>
<td style="text-align: left;">An optional hyphen (<code>-</code>)</td>
<td style="text-align: left;"><code>-</code></td>
</tr>
<tr class="even">
<td style="text-align: left;"><code>\\d*</code></td>
<td style="text-align: left;">Zero or more digits (<code>\d</code>)</td>
<td style="text-align: left;"><code>123</code>, ``</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><code>\\.?</code></td>
<td style="text-align: left;">An optional literal dot (`.`)</td>
<td style="text-align: left;">`.`</td>
</tr>
<tr class="even">
<td style="text-align: left;">`\d+`</td>
<td style="text-align: left;"><strong>One</strong> or more digits (`\d`)</td>
<td style="text-align: left;">`45`, `6`</td>
</tr>
<tr class="odd">
<td style="text-align: left;">`\s*`</td>
<td style="text-align: left;">Zero or more whitespace characters</td>
<td style="text-align: left;">` ` (space)</td>
</tr>
<tr class="even">
<td style="text-align: left;">`$`</td>
<td style="text-align: left;">End of the string</td>
<td style="text-align: left;"></td>
</tr>
</tbody>
</table>
<p><strong>In English</strong>: This pattern looks for strings that <strong>start</strong> (<code>^</code>), might have some spaces (<code>\s*</code>), might have a minus sign (<code>-?</code>), might have some digits (<code>\d*</code>), might have a decimal point (<code>\.?</code>), must have at least one digit (<code>\d+</code>), might have more spaces (<code>\s*</code>), and then must <strong>end</strong> (<code>$</code>).</p>
<p>This pattern will match <code>"5"</code>, <code>" -10.5 "</code>, and <code>".5"</code> but will <strong>not</strong> match <code>"5a"</code>, <code>"-$5"</code>, or <code>"1.2.3"</code>.</p>
<div style="height: 300px; background-color: white;">

</div>
</section>
<section id="across-for-mass-changes" class="level3">
<h3 class="anchored" data-anchor-id="across-for-mass-changes">7. <code>across()</code> for Mass Changes ‚ö°Ô∏è</h3>
<p><code>across()</code> is a super-powerful <code>dplyr</code> function that lets you apply the same operation to <strong>multiple columns at once</strong>. It‚Äôs almost always used inside <code>mutate()</code>.</p>
<p><strong>Fake Data</strong>: Scraped data often reads numbers as text.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a>scraped_measurements <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">id =</span> <span class="fu">c</span>(<span class="st">"A"</span>, <span class="st">"B"</span>, <span class="st">"C"</span>),</span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">width =</span> <span class="fu">c</span>(<span class="st">"10.5"</span>, <span class="st">"8"</span>, <span class="st">"9.1"</span>),</span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">height =</span> <span class="fu">c</span>(<span class="st">" 5.2 "</span>, <span class="st">"-3"</span>, <span class="st">"7.7"</span>),</span>
<span id="cb14-5"><a href="#cb14-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">comment =</span> <span class="fu">c</span>(<span class="st">"ok"</span>, <span class="st">"good"</span>, <span class="st">"perfect"</span>)</span>
<span id="cb14-6"><a href="#cb14-6" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p><strong>Code Demo</strong>: Let‚Äôs convert every column that looks like a number into an actual numeric type. We‚Äôll use the <code>regex</code> from before.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a>numeric_data <span class="ot">&lt;-</span> scraped_measurements <span class="sc">%&gt;%</span></span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="fu">across</span>(<span class="fu">where</span>(<span class="sc">~</span> <span class="fu">all</span>(<span class="fu">grepl</span>(<span class="st">"^</span><span class="sc">\\</span><span class="st">s*-?</span><span class="sc">\\</span><span class="st">d*</span><span class="sc">\\</span><span class="st">.?</span><span class="sc">\\</span><span class="st">d+</span><span class="sc">\\</span><span class="st">s*$"</span>, .x))), <span class="sc">~</span> <span class="fu">as.numeric</span>(.)))</span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(numeric_data)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<ul>
<li><code>mutate(across(...))</code>: We are changing columns.</li>
<li><code>where(~ all(grepl(...)))</code>: This part <strong>selects the columns</strong>. It tests every column (<code>where</code>) to see if (<code>~</code>) <strong>all</strong> of its values match (<code>grepl</code>) our numeric <code>regex</code> pattern. It finds <code>width</code> and <code>height</code>.</li>
<li><code>~ as.numeric(.)</code>: This part is the <strong>action</strong>. It takes the selected columns (<code>.</code>) and applies the <code>as.numeric</code> function to them.</li>
</ul>
<div style="height: 300px; background-color: white;">

</div>
</section>
<section id="conditional-logic-with-case_when" class="level3">
<h3 class="anchored" data-anchor-id="conditional-logic-with-case_when">8. Conditional Logic with <code>case_when</code> ü§î</h3>
<p><code>case_when()</code> is for creating a new column based on a set of <code>if/then</code> rules. It‚Äôs much easier to read than nested <code>ifelse()</code> statements. The syntax is <strong><code>condition ~ value</code></strong>.</p>
<p><strong>Fake Data</strong>: Let‚Äôs use the numeric data we just created.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a>numeric_data</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p><strong>Code Demo</strong>: Let‚Äôs create a <code>size_category</code> based on the <code>width</code> column.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a>numeric_data <span class="sc">%&gt;%</span></span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">size_category =</span> <span class="fu">case_when</span>(</span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a>      width <span class="sc">&gt;=</span> <span class="dv">10</span>   <span class="sc">~</span> <span class="st">"Large"</span>,</span>
<span id="cb17-5"><a href="#cb17-5" aria-hidden="true" tabindex="-1"></a>      width <span class="sc">&gt;=</span> <span class="dv">9</span>    <span class="sc">~</span> <span class="st">"Medium"</span>,</span>
<span id="cb17-6"><a href="#cb17-6" aria-hidden="true" tabindex="-1"></a>      <span class="cn">TRUE</span>          <span class="sc">~</span> <span class="st">"Small"</span></span>
<span id="cb17-7"><a href="#cb17-7" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb17-8"><a href="#cb17-8" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<ul>
<li><code>case_when()</code> checks each rule in order. The first one that is <code>TRUE</code> wins.</li>
<li><code>width &gt;= 10 ~ "Large"</code>: If width is 10 or more, the value is ‚ÄúLarge‚Äù.</li>
<li><code>width &gt;= 9 ~ "Medium"</code>: If not, but width is 9 or more, it‚Äôs ‚ÄúMedium‚Äù.</li>
<li><code>TRUE ~ "Small"</code>: This is the catch-all. If none of the above rules were met, the value is ‚ÄúSmall‚Äù. <code>TRUE</code> always evaluates to true, so it works like an <code>else</code> statement.</li>
</ul>
<div style="height: 300px; background-color: white;">

</div>
</section>
</section>
<section id="p2.-html-concepts" class="level2">
<h2 class="anchored" data-anchor-id="p2.-html-concepts">P2. HTML Concepts</h2>
<section id="how-html-builds-a-web-page" class="level3">
<h3 class="anchored" data-anchor-id="how-html-builds-a-web-page">How HTML Builds a Web Page</h3>
<p>To understand web scraping, we first need to see how a web browser reads HTML code to display a page.</p>
<section id="the-rendered-page-what-you-see" class="level4">
<h4 class="anchored" data-anchor-id="the-rendered-page-what-you-see">1. The Rendered Page (What You See)</h4>
<p>This is the final, visual webpage that you interact with in a browser. It‚Äôs designed to be human-readable.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="images/html_page_face.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="446"></p>
</figure>
</div>
<div style="height: 300px; background-color: white;">

</div>
</section>
<section id="the-html-code-what-the-computer-sees" class="level4">
<h4 class="anchored" data-anchor-id="the-html-code-what-the-computer-sees">2. The HTML Code (What the Computer Sees)</h4>
<p>Behind every webpage is the raw HTML code. This code acts as the blueprint, telling the browser what content to display and how to structure it.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="images/html_page_guts.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="439"></p>
</figure>
</div>
</section>
</section>
<section id="finding-a-specific-element-the-table" class="level3">
<h3 class="anchored" data-anchor-id="finding-a-specific-element-the-table">Finding a Specific Element: The Table</h3>
<p>Let‚Äôs focus on a specific part of the page: the data tables.</p>
<div style="height: 300px; background-color: white;">

</div>
<section id="the-tables-on-the-rendered-page" class="level4">
<h4 class="anchored" data-anchor-id="the-tables-on-the-rendered-page">1. The Tables on the Rendered Page</h4>
<p>When we scrape, our goal is to extract specific information, like the data in these two tables.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="images/html_page_face_selected_tables.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="471"></p>
</figure>
</div>
<div style="height: 300px; background-color: white;">

</div>
</section>
<section id="the-table-tags-in-the-html-code" class="level4">
<h4 class="anchored" data-anchor-id="the-table-tags-in-the-html-code">2. The <code>&lt;table&gt;</code> Tags in the HTML Code</h4>
<p>To extract those tables, we need to find the code that creates them. In HTML, tables are defined by <code>&lt;table&gt;</code> tags, which contain all the data and structure for a specific table.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="images/html_page_guts_selected_tables.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="516"></p>
</figure>
</div>
<div style="height: 300px; background-color: white;">

</div>
</section>
</section>
<section id="anatomy-of-an-html-table" class="level3">
<h3 class="anchored" data-anchor-id="anatomy-of-an-html-table">Anatomy of an HTML Table</h3>
<p>An HTML table is built from a set of nested tags that define its structure and content.</p>
<ul>
<li><p><code>&lt;table&gt;&lt;/table&gt;</code> This tag is the main container that wraps around all the content for an entire table.</p></li>
<li><p><code>&lt;thead&gt;&lt;/thead&gt;</code> This tag defines the header section of a table, where you place the row containing the column titles.</p></li>
<li><p><code>&lt;th&gt;&lt;/th&gt;</code> A <strong>t</strong>able <strong>h</strong>eader cell, used for column titles. Text inside a <code>&lt;th&gt;</code> tag is typically bold and centered by default.</p></li>
<li><p><code>&lt;tr&gt;&lt;/tr&gt;</code> A <strong>t</strong>able <strong>r</strong>ow, which groups together all the cells (<code>&lt;th&gt;</code> or <code>&lt;td&gt;</code>) that belong in a single horizontal line.</p></li>
<li><p><code>&lt;td&gt;&lt;/td&gt;</code> A <strong>t</strong>able <strong>d</strong>ata cell, which contains the individual pieces of data in the table‚Äôs body.</p></li>
</ul>
<div style="height: 300px; background-color: white;">

</div>
</section>
</section>
<section id="p3.-desired-rvest-functions" class="level2">
<h2 class="anchored" data-anchor-id="p3.-desired-rvest-functions">P3. Desired <code>rvest</code> functions</h2>
<section id="p_sub_1-reading-the-html-file" class="level3">
<h3 class="anchored" data-anchor-id="p_sub_1-reading-the-html-file">P_sub_1: Reading the HTML File</h3>
<p>First, we load our libraries and read the HTML file into an R object. This step remains the same.</p>
<p><img src="images/extract_1.gif" class="img-fluid"></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(rvest)</span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(purrr)</span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(here)</span>
<span id="cb18-4"><a href="#cb18-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-5"><a href="#cb18-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-6"><a href="#cb18-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Read the local HTML file into an R object</span></span>
<span id="cb18-7"><a href="#cb18-7" aria-hidden="true" tabindex="-1"></a>iowa_html_page <span class="ot">&lt;-</span>  <span class="fu">here</span>(<span class="st">"sessions"</span>,<span class="st">"session_3"</span>,<span class="st">"fake_iowa_data.html"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb18-8"><a href="#cb18-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">read_html</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div style="height: 300px; background-color: white;">

</div>
</section>
<section id="p_sub_2-extracting-the-first-table-with-pluck" class="level3">
<h3 class="anchored" data-anchor-id="p_sub_2-extracting-the-first-table-with-pluck">P_sub_2: Extracting the First Table with <code>pluck()</code></h3>
<p>Instead of using <code>[[1]]</code>, we can pipe the output of <code>html_table()</code> directly into <code>pluck()</code>. We tell <code>pluck()</code> to retrieve the <strong>first</strong> element from the list of tables.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Use pluck() to get the first table from the list</span></span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a>production_df <span class="ot">&lt;-</span> iowa_html_page  <span class="sc">%&gt;%</span> </span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">html_table</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb19-4"><a href="#cb19-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pluck</span>(<span class="dv">1</span>)</span>
<span id="cb19-5"><a href="#cb19-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-6"><a href="#cb19-6" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(production_df)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div style="height: 300px; background-color: white;">

</div>
</section>
<section id="p_sub_3-extracting-the-second-table-with-pluck" class="level3">
<h3 class="anchored" data-anchor-id="p_sub_3-extracting-the-second-table-with-pluck">P_sub_3: Extracting the Second Table with <code>pluck()</code></h3>
<p>We can use the exact same process to get the second table. We simply change the index in <code>pluck()</code> from <code>1</code> to <code>2</code> to retrieve the <strong>second</strong> element from the list.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Use pluck() to get the second table</span></span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a>usage_df <span class="ot">&lt;-</span> page <span class="sc">%&gt;%</span> </span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">html_table</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb20-4"><a href="#cb20-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pluck</span>(<span class="dv">2</span>)</span>
<span id="cb20-5"><a href="#cb20-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-6"><a href="#cb20-6" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(usage_df)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div style="height: 300px; background-color: white;">

</div>
<p><img src="images/extract_2.gif" class="img-fluid"></p>
</section>
</section>
<section id="p4.-extract-nfl-data" class="level2">
<h2 class="anchored" data-anchor-id="p4.-extract-nfl-data">P4. Extract NFL Data</h2>
<p>Let‚Äôs go to this html page.</p>
<p><a href="https://www.pro-football-reference.com/teams/was/2023.htm#games" class="uri">https://www.pro-football-reference.com/teams/was/2023.htm#games</a></p>
<p>Our desired table is the 2023 Regular Season Table for the Washington Commanders, which is the second table on the webpage.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="images/clipboard-2159826445.png" class="img-fluid figure-img"></p>
<figcaption>This is the table we are after</figcaption>
</figure>
</div>
<section id="step-1-retrieve-the-game-data" class="level3">
<h3 class="anchored" data-anchor-id="step-1-retrieve-the-game-data">Step 1: Retrieve the Game Data</h3>
<p>First, we define our parameters (team and year), build the full URL, read the HTML from the page, and then use <code>rvest</code> and <code>purrr</code> to extract the specific table containing the game data we want.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="co"># ## EMPTY VERSION</span></span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a><span class="co"># library(httr2)</span></span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a><span class="co"># library(rvest)</span></span>
<span id="cb21-4"><a href="#cb21-4" aria-hidden="true" tabindex="-1"></a><span class="co"># library(glue)</span></span>
<span id="cb21-5"><a href="#cb21-5" aria-hidden="true" tabindex="-1"></a><span class="co"># library(purrr)</span></span>
<span id="cb21-6"><a href="#cb21-6" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb21-7"><a href="#cb21-7" aria-hidden="true" tabindex="-1"></a><span class="co"># # Define team and year</span></span>
<span id="cb21-8"><a href="#cb21-8" aria-hidden="true" tabindex="-1"></a><span class="co"># team_name &lt;- "____"</span></span>
<span id="cb21-9"><a href="#cb21-9" aria-hidden="true" tabindex="-1"></a><span class="co"># year &lt;- ____</span></span>
<span id="cb21-10"><a href="#cb21-10" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb21-11"><a href="#cb21-11" aria-hidden="true" tabindex="-1"></a><span class="co"># # Construct full URL</span></span>
<span id="cb21-12"><a href="#cb21-12" aria-hidden="true" tabindex="-1"></a><span class="co"># generic_url &lt;- glue("https://www.pro-football-reference.com/teams/{____}/{____}.htm#all_games")</span></span>
<span id="cb21-13"><a href="#cb21-13" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb21-14"><a href="#cb21-14" aria-hidden="true" tabindex="-1"></a><span class="co"># # Read HTML page and extract tables</span></span>
<span id="cb21-15"><a href="#cb21-15" aria-hidden="true" tabindex="-1"></a><span class="co"># webpage &lt;- read_html(____)</span></span>
<span id="cb21-16"><a href="#cb21-16" aria-hidden="true" tabindex="-1"></a><span class="co"># web_tables &lt;- html_table(____)</span></span>
<span id="cb21-17"><a href="#cb21-17" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb21-18"><a href="#cb21-18" aria-hidden="true" tabindex="-1"></a><span class="co"># # Pluck the second table (regular season games)</span></span>
<span id="cb21-19"><a href="#cb21-19" aria-hidden="true" tabindex="-1"></a><span class="co"># game_table &lt;- pluck(____, ____)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="do">## FILLED VERSION</span></span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(httr2)</span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(rvest)</span>
<span id="cb22-4"><a href="#cb22-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(glue)</span>
<span id="cb22-5"><a href="#cb22-5" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(purrr)</span>
<span id="cb22-6"><a href="#cb22-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-7"><a href="#cb22-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Define team and year</span></span>
<span id="cb22-8"><a href="#cb22-8" aria-hidden="true" tabindex="-1"></a>team_name <span class="ot">&lt;-</span> <span class="st">"was"</span></span>
<span id="cb22-9"><a href="#cb22-9" aria-hidden="true" tabindex="-1"></a>year <span class="ot">&lt;-</span> <span class="dv">2023</span></span>
<span id="cb22-10"><a href="#cb22-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-11"><a href="#cb22-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Construct full URL</span></span>
<span id="cb22-12"><a href="#cb22-12" aria-hidden="true" tabindex="-1"></a>generic_url <span class="ot">&lt;-</span> <span class="fu">glue</span>(<span class="st">"https://www.pro-football-reference.com/teams/{team_name}/{year}.htm#all_games"</span>)</span>
<span id="cb22-13"><a href="#cb22-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-14"><a href="#cb22-14" aria-hidden="true" tabindex="-1"></a><span class="co"># Read HTML page and extract tables</span></span>
<span id="cb22-15"><a href="#cb22-15" aria-hidden="true" tabindex="-1"></a>webpage <span class="ot">&lt;-</span> <span class="fu">read_html</span>(generic_url)</span>
<span id="cb22-16"><a href="#cb22-16" aria-hidden="true" tabindex="-1"></a>web_tables <span class="ot">&lt;-</span> <span class="fu">html_table</span>(webpage)</span>
<span id="cb22-17"><a href="#cb22-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-18"><a href="#cb22-18" aria-hidden="true" tabindex="-1"></a><span class="co"># Pluck the second table (regular season games)</span></span>
<span id="cb22-19"><a href="#cb22-19" aria-hidden="true" tabindex="-1"></a>game_table <span class="ot">&lt;-</span> <span class="fu">pluck</span>(web_tables, <span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<hr>
</section>
<section id="step-2-clean-the-column-headers" class="level3">
<h3 class="anchored" data-anchor-id="step-2-clean-the-column-headers">Step 2: Clean the Column Headers</h3>
<p>Scraped tables often have messy headers. The first row of this table contains the real column names. We will extract that row, set it as the new headers, remove the now-redundant first row, and finally use the <strong><code>janitor</code></strong> package to standardize the names into a clean format.</p>
<p><strong>Note:</strong> Sometimes we have to refer to base R syntax (like <code>colnames()</code> and <code>[-1,]</code>) because modern <code>tidyverse</code> methods may not be the most direct tool for a specific, low-level task like this.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="co"># ## EMPTY VERSION</span></span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a><span class="co"># library(janitor)</span></span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb23-4"><a href="#cb23-4" aria-hidden="true" tabindex="-1"></a><span class="co"># # Use first row as column names</span></span>
<span id="cb23-5"><a href="#cb23-5" aria-hidden="true" tabindex="-1"></a><span class="co"># firstrow_names &lt;- ____[1, ] %&gt;% </span></span>
<span id="cb23-6"><a href="#cb23-6" aria-hidden="true" tabindex="-1"></a><span class="co">#   unlist() %&gt;% </span></span>
<span id="cb23-7"><a href="#cb23-7" aria-hidden="true" tabindex="-1"></a><span class="co">#   as.character()</span></span>
<span id="cb23-8"><a href="#cb23-8" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb23-9"><a href="#cb23-9" aria-hidden="true" tabindex="-1"></a><span class="co"># # Assign as column names</span></span>
<span id="cb23-10"><a href="#cb23-10" aria-hidden="true" tabindex="-1"></a><span class="co"># colnames(____) &lt;- ____</span></span>
<span id="cb23-11"><a href="#cb23-11" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb23-12"><a href="#cb23-12" aria-hidden="true" tabindex="-1"></a><span class="co"># # Remove the first row and clean names</span></span>
<span id="cb23-13"><a href="#cb23-13" aria-hidden="true" tabindex="-1"></a><span class="co"># table_1 &lt;- ____[-1, ]</span></span>
<span id="cb23-14"><a href="#cb23-14" aria-hidden="true" tabindex="-1"></a><span class="co"># table_2 &lt;- clean__names(____)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="do">## FILLED VERSION</span></span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(janitor)</span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-4"><a href="#cb24-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Use first row as column names</span></span>
<span id="cb24-5"><a href="#cb24-5" aria-hidden="true" tabindex="-1"></a>firstrow_names <span class="ot">&lt;-</span> game_table[<span class="dv">1</span>, ] <span class="sc">%&gt;%</span> </span>
<span id="cb24-6"><a href="#cb24-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">unlist</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb24-7"><a href="#cb24-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as.character</span>()</span>
<span id="cb24-8"><a href="#cb24-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-9"><a href="#cb24-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Assign as column names</span></span>
<span id="cb24-10"><a href="#cb24-10" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(game_table) <span class="ot">&lt;-</span> firstrow_names</span>
<span id="cb24-11"><a href="#cb24-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-12"><a href="#cb24-12" aria-hidden="true" tabindex="-1"></a><span class="co"># Remove the first row and clean names</span></span>
<span id="cb24-13"><a href="#cb24-13" aria-hidden="true" tabindex="-1"></a>table_1 <span class="ot">&lt;-</span> game_table[<span class="sc">-</span><span class="dv">1</span>, ]</span>
<span id="cb24-14"><a href="#cb24-14" aria-hidden="true" tabindex="-1"></a><span class="co"># table_2 &lt;- clean__names(table_1)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<hr>
</section>
<section id="step-3-tidy-and-transform-the-data" class="level3">
<h3 class="anchored" data-anchor-id="step-3-tidy-and-transform-the-data">Step 3: Tidy and Transform the Data</h3>
<p>The final step is to reshape the data into a truly usable format. This involves renaming poorly named columns, removing irrelevant columns and bye weeks, converting columns that look like numbers from text to numeric, and correctly setting categorical variables (<code>factors</code>).</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a><span class="co"># ## EMPTY VERSION</span></span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a><span class="co"># library(dplyr)</span></span>
<span id="cb25-3"><a href="#cb25-3" aria-hidden="true" tabindex="-1"></a><span class="co"># library(stringr)</span></span>
<span id="cb25-4"><a href="#cb25-4" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb25-5"><a href="#cb25-5" aria-hidden="true" tabindex="-1"></a><span class="co"># # Rename, select, and filter</span></span>
<span id="cb25-6"><a href="#cb25-6" aria-hidden="true" tabindex="-1"></a><span class="co"># table_4 &lt;- table_2 %&gt;% </span></span>
<span id="cb25-7"><a href="#cb25-7" aria-hidden="true" tabindex="-1"></a><span class="co">#   rename(</span></span>
<span id="cb25-8"><a href="#cb25-8" aria-hidden="true" tabindex="-1"></a><span class="co">#     result = ____,</span></span>
<span id="cb25-9"><a href="#cb25-9" aria-hidden="true" tabindex="-1"></a><span class="co">#     game_location = ____</span></span>
<span id="cb25-10"><a href="#cb25-10" aria-hidden="true" tabindex="-1"></a><span class="co">#   ) %&gt;% </span></span>
<span id="cb25-11"><a href="#cb25-11" aria-hidden="true" tabindex="-1"></a><span class="co">#   select(!(____:____)) %&gt;% </span></span>
<span id="cb25-12"><a href="#cb25-12" aria-hidden="true" tabindex="-1"></a><span class="co">#   filter(opp != "____")</span></span>
<span id="cb25-13"><a href="#cb25-13" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb25-14"><a href="#cb25-14" aria-hidden="true" tabindex="-1"></a><span class="co"># # Convert types</span></span>
<span id="cb25-15"><a href="#cb25-15" aria-hidden="true" tabindex="-1"></a><span class="co"># table_6 &lt;- table_4 %&gt;%  </span></span>
<span id="cb25-16"><a href="#cb25-16" aria-hidden="true" tabindex="-1"></a><span class="co">#   mutate(across(where(~ all(grepl("^\\s*-?\\d*\\.?\\d+\\s*$", .x))), ~ as.numeric(.))) %&gt;% </span></span>
<span id="cb25-17"><a href="#cb25-17" aria-hidden="true" tabindex="-1"></a><span class="co">#   mutate(</span></span>
<span id="cb25-18"><a href="#cb25-18" aria-hidden="true" tabindex="-1"></a><span class="co">#     result = as.factor(____),</span></span>
<span id="cb25-19"><a href="#cb25-19" aria-hidden="true" tabindex="-1"></a><span class="co">#     game_location = case_when(</span></span>
<span id="cb25-20"><a href="#cb25-20" aria-hidden="true" tabindex="-1"></a><span class="co">#       game_location == "@" ~ "____",</span></span>
<span id="cb25-21"><a href="#cb25-21" aria-hidden="true" tabindex="-1"></a><span class="co">#       game_location == "" ~ "____",</span></span>
<span id="cb25-22"><a href="#cb25-22" aria-hidden="true" tabindex="-1"></a><span class="co">#       TRUE ~ ____</span></span>
<span id="cb25-23"><a href="#cb25-23" aria-hidden="true" tabindex="-1"></a><span class="co">#     ) %&gt;% as.factor()</span></span>
<span id="cb25-24"><a href="#cb25-24" aria-hidden="true" tabindex="-1"></a><span class="co">#   )</span></span>
<span id="cb25-25"><a href="#cb25-25" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb25-26"><a href="#cb25-26" aria-hidden="true" tabindex="-1"></a><span class="co"># # Final column name cleanup</span></span>
<span id="cb25-27"><a href="#cb25-27" aria-hidden="true" tabindex="-1"></a><span class="co"># final_games_df &lt;- table_6 %&gt;% </span></span>
<span id="cb25-28"><a href="#cb25-28" aria-hidden="true" tabindex="-1"></a><span class="co">#   rename_with(~ str_replace(., "^_", ""), .cols = starts_with("____"))</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a><span class="do">## FILLED VERSION</span></span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb26-3"><a href="#cb26-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(stringr)</span>
<span id="cb26-4"><a href="#cb26-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-5"><a href="#cb26-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Rename, select, and filter</span></span>
<span id="cb26-6"><a href="#cb26-6" aria-hidden="true" tabindex="-1"></a>table_4 <span class="ot">&lt;-</span> table_2 <span class="sc">%&gt;%</span> </span>
<span id="cb26-7"><a href="#cb26-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(</span>
<span id="cb26-8"><a href="#cb26-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">result =</span> x_3,</span>
<span id="cb26-9"><a href="#cb26-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">game_location =</span> x_4</span>
<span id="cb26-10"><a href="#cb26-10" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span> </span>
<span id="cb26-11"><a href="#cb26-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">!</span>(x<span class="sc">:</span>x_2)) <span class="sc">%&gt;%</span> </span>
<span id="cb26-12"><a href="#cb26-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(opp <span class="sc">!=</span> <span class="st">"Bye Week"</span>)</span>
<span id="cb26-13"><a href="#cb26-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-14"><a href="#cb26-14" aria-hidden="true" tabindex="-1"></a><span class="co"># Convert types</span></span>
<span id="cb26-15"><a href="#cb26-15" aria-hidden="true" tabindex="-1"></a>table_6 <span class="ot">&lt;-</span> table_4 <span class="sc">%&gt;%</span>  </span>
<span id="cb26-16"><a href="#cb26-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="fu">across</span>(<span class="fu">where</span>(<span class="sc">~</span> <span class="fu">all</span>(<span class="fu">grepl</span>(<span class="st">"^</span><span class="sc">\\</span><span class="st">s*-?</span><span class="sc">\\</span><span class="st">d*</span><span class="sc">\\</span><span class="st">.?</span><span class="sc">\\</span><span class="st">d+</span><span class="sc">\\</span><span class="st">s*$"</span>, .x))), <span class="sc">~</span> <span class="fu">as.numeric</span>(.))) <span class="sc">%&gt;%</span> </span>
<span id="cb26-17"><a href="#cb26-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb26-18"><a href="#cb26-18" aria-hidden="true" tabindex="-1"></a>    <span class="at">result =</span> <span class="fu">as.factor</span>(result),</span>
<span id="cb26-19"><a href="#cb26-19" aria-hidden="true" tabindex="-1"></a>    <span class="at">game_location =</span> <span class="fu">case_when</span>(</span>
<span id="cb26-20"><a href="#cb26-20" aria-hidden="true" tabindex="-1"></a>      game_location <span class="sc">==</span> <span class="st">"@"</span> <span class="sc">~</span> <span class="st">"away"</span>,</span>
<span id="cb26-21"><a href="#cb26-21" aria-hidden="true" tabindex="-1"></a>      game_location <span class="sc">==</span> <span class="st">""</span> <span class="sc">~</span> <span class="st">"home"</span>,</span>
<span id="cb26-22"><a href="#cb26-22" aria-hidden="true" tabindex="-1"></a>      <span class="cn">TRUE</span> <span class="sc">~</span> game_location</span>
<span id="cb26-23"><a href="#cb26-23" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">%&gt;%</span>  <span class="fu">as.factor</span>()</span>
<span id="cb26-24"><a href="#cb26-24" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb26-25"><a href="#cb26-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-26"><a href="#cb26-26" aria-hidden="true" tabindex="-1"></a><span class="co"># Final column name cleanup</span></span>
<span id="cb26-27"><a href="#cb26-27" aria-hidden="true" tabindex="-1"></a>final_games_df <span class="ot">&lt;-</span> table_6 <span class="sc">%&gt;%</span> </span>
<span id="cb26-28"><a href="#cb26-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename_with</span>(<span class="sc">~</span> <span class="fu">str_replace</span>(., <span class="st">"^_"</span>, <span class="st">""</span>), <span class="at">.cols =</span> <span class="fu">starts_with</span>(<span class="st">"_"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>


</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "Óßã";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->




</body></html>